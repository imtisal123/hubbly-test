# Hubbly App Database Schema Update

This directory contains scripts to update the Hubbly app database schema. The following files are included:

## SQL Scripts

1. `complete_schema_update.sql` - A comprehensive SQL script that creates all necessary tables and adds required columns.
2. `update_profiles_schema.sql` - Adds the `education` column to the profiles table.
3. `update_match_preferences_schema.sql` - Creates or updates the match_preferences table.
4. `update_family_details_schema.sql` - Creates or updates the family_details table.
5. `update_schema.sql` - Generated by `create_sql_script.js`, contains SQL commands for creating tables and updating schema.

## JavaScript Scripts

1. `create_sql_script.js` - Generates a SQL file with commands to create tables and update schema.
2. `check_profiles_schema.js` - Checks the schema of the profiles table.
3. `check_match_preferences_schema.js` - Checks the schema of the match_preferences table.
4. `create_test_admin_profiles_with_all_data.js` - Creates test admin profiles with complete data.

## How to Update the Database Schema

### Option 1: Using the Supabase Dashboard

1. Go to the Supabase dashboard for your project.
2. Navigate to the SQL Editor.
3. Copy and paste the contents of `complete_schema_update.sql`.
4. Execute the SQL commands.
5. Verify that the tables have been created successfully.

### Option 2: Using the REST API

If you prefer to use the REST API to update the schema, you can use the `create_tables_direct.js` script.

## Testing the Schema Update

After updating the schema, you can run the `create_test_admin_profiles_with_all_data.js` script to create test admin profiles and verify that data is saved correctly to all tables.

```bash
node scripts/create_test_admin_profiles_with_all_data.js
```

This script will create 5 admin users with diverse profile data and save them to the database.

## Troubleshooting

If you encounter any issues with the schema update, you can use the `check_profiles_schema.js` and `check_match_preferences_schema.js` scripts to check the current schema of the tables.

```bash
node scripts/check_profiles_schema.js
node scripts/check_match_preferences_schema.js
```

These scripts will display the available columns in the tables and help identify any missing columns or tables.
